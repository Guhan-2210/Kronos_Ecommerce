echo "ğŸ” Running pre-commit checks..."
echo ""

# Run lint-staged (includes: ESLint, Prettier, Tests with Coverage)
echo "ğŸ“ Running ESLint, Prettier, Tests & Coverage for changed workers..."
npx lint-staged

# Check if lint-staged failed (tests or linting)
if [ $? -ne 0 ]; then
  echo ""
  echo "âŒ Pre-commit checks failed!"
  echo "   Fix the issues above and try again."
  exit 1
fi

# Run Knip in non-blocking mode (warnings only)
echo ""
echo "ğŸ”ª Running Knip (dead code detection) - non-blocking..."
npx knip || echo "âš ï¸  Knip found some issues (non-blocking, commit will proceed)"

echo ""
echo "âœ… Pre-commit checks completed!"
echo "   âœ“ Linting passed"
echo "   âœ“ Formatting passed"
echo "   âœ“ Tests passed (for changed workers)"
echo "   âœ“ Coverage checked (for changed workers)"
